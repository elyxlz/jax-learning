
<!doctype html>
<html lang="en" class="no-js">
  
<!-- Mirrored from docs.kidger.site/equinox/api/nn/normalisation/ by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Jul 2024 11:53:49 GMT -->
<head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="The documentation for the Equinox software library.">
      
      
      
        <meta name="author" content="Patrick Kidger">
      
      
        <link rel="canonical" href="index.html">
      
      <link rel="icon" href="../../../_static/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-7.3.6">
    
    
      
        <title>Normalisation - Equinox</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.a57b2b03.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../_static/custom_css.css">
    
      <link rel="stylesheet" href="../../../css/ansi-colours.css">
    
      <link rel="stylesheet" href="../../../css/jupyter-cells.css">
    
      <link rel="stylesheet" href="../../../css/pandas-dataframe.css">
    
    
      


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="amber">
  
    
    <script>function __prefix(e){return new URL("../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
      <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#normalisation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../index.html" title="Equinox" class="md-header__button md-logo" aria-label="Equinox" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 10V8h2v2h-2m0 2v-2h-2v2h2m0-4V6h-2v2h2m-2-5.16V4h2c-.63-.46-1.29-.85-2-1.16M18 4v2h2c-.58-.75-1.25-1.42-2-2m2 2v2h1.16c-.31-.71-.7-1.37-1.16-2m2 6c0-.68-.07-1.35-.2-2H20v2h2m-6-6V4h-2v2h2m0 10h2v-2h-2v2m2 2h2v-2h-2v2m-2 2h2v-2h-2v2m-2 1.8c.7-.14 1.36-.36 2-.64V20h-2v1.8m4-7.8h2v-2h-2v2m-2-6h-2v2h2V8m4 8h1.16c.28-.64.5-1.3.64-2H20v2m-4-4h-2v2h2v-2m-4 6v-2h2v-2h-2v-2h2v-2h-2V8h2V6h-2V4h2V2.2c-.65-.13-1.31-.2-2-.2C6.5 2 2 6.5 2 12s4.5 10 10 10v-2h2v-2h-2m2 0h2v-2h-2v2z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Equinox
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Normalisation
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/patrick-kidger/equinox" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    patrick-kidger/equinox
  </div>
</a>

<a href="https://twitter.com/PatrickKidger" title="Go to Twitter" class="md-source">
  <div class="md-source__icon md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
  </div>
  <div class="md-source__repository">
    @PatrickKidger
  </div>
</a>

      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../index.html" title="Equinox" class="md-nav__button md-logo" aria-label="Equinox" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 10V8h2v2h-2m0 2v-2h-2v2h2m0-4V6h-2v2h2m-2-5.16V4h2c-.63-.46-1.29-.85-2-1.16M18 4v2h2c-.58-.75-1.25-1.42-2-2m2 2v2h1.16c-.31-.71-.7-1.37-1.16-2m2 6c0-.68-.07-1.35-.2-2H20v2h2m-6-6V4h-2v2h2m0 10h2v-2h-2v2m2 2h2v-2h-2v2m-2 2h2v-2h-2v2m-2 1.8c.7-.14 1.36-.36 2-.64V20h-2v1.8m4-7.8h2v-2h-2v2m-2-6h-2v2h2V8m4 8h1.16c.28-.64.5-1.3.64-2H20v2m-4-4h-2v2h2v-2m-4 6v-2h2v-2h-2v-2h2v-2h-2V8h2V6h-2V4h2V2.2c-.65-.13-1.31-.2-2-.2C6.5 2 2 6.5 2 12s4.5 10 10 10v-2h2v-2h-2m2 0h2v-2h-2v2z"/></svg>

    </a>
    Equinox
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/patrick-kidger/equinox" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    patrick-kidger/equinox
  </div>
</a>

<a href="https://twitter.com/PatrickKidger" title="Go to Twitter" class="md-source">
  <div class="md-source__icon md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
  </div>
  <div class="md-source__repository">
    @PatrickKidger
  </div>
</a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../index.html" class="md-nav__link">
        Getting started
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../all-of-equinox/index.html" class="md-nav__link">
        All of Equinox
      </a>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Examples" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1" type="checkbox" id="__nav_3_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1">
          Introductory
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Introductory" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          Introductory
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/mnist/index.html" class="md-nav__link">
        CNN on MNIST
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/train_rnn/index.html" class="md-nav__link">
        Train RNN
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_2">
          Advanced
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Advanced" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Advanced
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/score_based_diffusion/index.html" class="md-nav__link">
        Generative score-based diffusion
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/bert/index.html" class="md-nav__link">
        BERT language model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/unet/index.html" class="md-nav__link">
        U-Net implementation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/vision_transformer/index.html" class="md-nav__link">
        Vision transformer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/deep_convolutional_gan/index.html" class="md-nav__link">
        Image GAN
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/mistral_7b/index.html" class="md-nav__link">
        Mistral 7B
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" type="checkbox" id="__nav_3_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_3">
          Features
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Features" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          Features
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/frozen_layer/index.html" class="md-nav__link">
        Freezing parameters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/init_apply/index.html" class="md-nav__link">
        Compatibility with init-apply libraries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/stateful/index.html" class="md-nav__link">
        Stateful operations (e.g. BatchNorm)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/parallelism/index.html" class="md-nav__link">
        Autoparallelism (e.g. multi-GPU)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/serialisation/index.html" class="md-nav__link">
        Serialisation (with hyperparameters)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Basic API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Basic API" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Basic API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" type="checkbox" id="__nav_4_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_1">
          Modules
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Modules" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Modules
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../module/module/index.html" class="md-nav__link">
        Module
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../module/advanced_fields/index.html" class="md-nav__link">
        Extra features
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2">
          Neural network layers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Neural network layers" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Neural network layers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../linear/index.html" class="md-nav__link">
        Linear
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../conv/index.html" class="md-nav__link">
        Convolutional
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rnn/index.html" class="md-nav__link">
        Recurrent
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../attention/index.html" class="md-nav__link">
        Attention
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../activations/index.html" class="md-nav__link">
        Activations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pool/index.html" class="md-nav__link">
        Pooling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../dropout/index.html" class="md-nav__link">
        Dropout
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Normalisation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="index.html" class="md-nav__link md-nav__link--active">
        Normalisation
      </a>
      
        


<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#equinox.nn.LayerNorm" class="md-nav__link">
    LayerNorm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#equinox.nn.RMSNorm" class="md-nav__link">
    RMSNorm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#equinox.nn.GroupNorm" class="md-nav__link">
    GroupNorm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#equinox.nn.BatchNorm" class="md-nav__link">
    BatchNorm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#equinox.nn.SpectralNorm" class="md-nav__link">
    SpectralNorm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#equinox.nn.WeightNorm" class="md-nav__link">
    WeightNorm
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../embedding/index.html" class="md-nav__link">
        Embeddings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mlp/index.html" class="md-nav__link">
        Multi-layer perceptron
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sequential/index.html" class="md-nav__link">
        Sequential
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../inference/index.html" class="md-nav__link">
        Training/Inference
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../shared/index.html" class="md-nav__link">
        Sharing layers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../stateful/index.html" class="md-nav__link">
        Stateful operations
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../transformations/index.html" class="md-nav__link">
        Transformations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../manipulation/index.html" class="md-nav__link">
        Manipulating PyTrees
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Advanced API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Advanced API" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Advanced API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../caches/index.html" class="md-nav__link">
        Clear caches
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../debug/index.html" class="md-nav__link">
        Debugging tools
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../enumerations/index.html" class="md-nav__link">
        Enumerations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../errors/index.html" class="md-nav__link">
        Runtime errors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pretty-printing/index.html" class="md-nav__link">
        Pretty printing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../serialisation/index.html" class="md-nav__link">
        Serialisation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Misc
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Misc" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Misc
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../faq/index.html" class="md-nav__link">
        FAQ
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tricks/index.html" class="md-nav__link">
        Tricks (ensembles, surgery, custom initialisations, ...)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../citation/index.html" class="md-nav__link">
        Citation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="normalisation">Normalisation<a class="headerlink" href="#normalisation" title="Permanent link">¤</a></h1>


  <div class="doc doc-object doc-class">



<h4 id="equinox.nn.LayerNorm" class="doc doc-heading">
        <code>
equinox.nn.LayerNorm            (<a class="autorefs autorefs-internal" title="equinox.Module" href="../../module/module/index.html#equinox.Module">Module</a>)
        </code>



<a href="#equinox.nn.LayerNorm" class="headerlink" title="Permanent link">¤</a></h4>

    <div class="doc doc-contents first">

      <p>Computes a mean and standard deviation over the whole input array, and uses these
to normalise the whole array. Optionally applies an elementwise affine
transformation afterwards.</p>
<p>Given an input array <span class="arithmatex">\(x\)</span>, this layer computes</p>
<div class="arithmatex">\[\frac{x - \mathbb{E}[x]}{\sqrt{\text{Var}[x] + \varepsilon}} * \gamma + \beta\]</div>
<p>where <span class="arithmatex">\(\gamma\)</span>, <span class="arithmatex">\(\beta\)</span> have the same shape as <span class="arithmatex">\(x\)</span> if <code>elementwise_affine=True</code>,
and <span class="arithmatex">\(\gamma = 1\)</span>, <span class="arithmatex">\(\beta = 0\)</span> if <code>elementwise_affine=False</code>.</p>
<details class="cite">
<summary>Cite</summary>
<p><a href="https://arxiv.org/abs/1607.06450">Layer Normalization</a></p>
<div class="highlight"><pre><span></span><code><span class="nc">@article</span><span class="p">{</span><span class="nl">ba2016layer</span><span class="p">,</span>
<span class="w">    </span><span class="na">author</span><span class="p">=</span><span class="s">{Jimmy Lei Ba, Jamie Ryan Kriso, Geoffrey E. Hinton}</span><span class="p">,</span>
<span class="w">    </span><span class="na">title</span><span class="p">=</span><span class="s">{Layer Normalization}</span><span class="p">,</span>
<span class="w">    </span><span class="na">year</span><span class="p">=</span><span class="s">{2016}</span><span class="p">,</span>
<span class="w">    </span><span class="na">journal</span><span class="p">=</span><span class="s">{arXiv:1607.06450}</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div>
</details>
<div class="admonition faq">
<p class="admonition-title">FAQ</p>
<p>If you need to normalise over only some input dimensions, then this can be
achieved by vmap'ing. For example the following will compute statistics over
every dimension <em>except</em> the first:
<div class="highlight"><pre><span></span><code><span class="n">layer</span> <span class="o">=</span> <span class="n">LayerNorm</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">array</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">layer</span><span class="p">)(</span><span class="n">array</span><span class="p">)</span>
</code></pre></div></p>
</div>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h5 id="equinox.nn.LayerNorm.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span> <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-05</span><span class="p">,</span> <span class="n">use_weight</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">elementwise_affine</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span></code>


<a href="#equinox.nn.LayerNorm.__init__" class="headerlink" title="Permanent link">¤</a></h5>

    <div class="doc doc-contents ">

      <p><strong>Arguments:</strong></p>
<ul>
<li><code>shape</code>: Shape of the input.</li>
<li><code>eps</code>: Value added to denominator for numerical stability.</li>
<li><code>use_weight</code>: Whether the module has learnable affine weights.</li>
<li><code>use_bias</code>: Whether the module has learnable affine biases.</li>
<li><code>dtype</code>: The dtype to use for the weight and the bias in this layer if
    <code>use_weight</code> or <code>use_bias</code> is set to <code>True</code>.
    Defaults to either <code>jax.numpy.float32</code> or <code>jax.numpy.float64</code> depending
    on whether JAX is in 64-bit mode.</li>
<li><code>elementwise_affine</code>: Deprecated alternative to <code>use_weight</code> and <code>use_bias</code>.</li>
</ul>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="equinox.nn.LayerNorm.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">State</span> <span class="o">=</span> <span class="n">sentinel</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PRNGKeyArray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Array</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Array</span><span class="p">,</span> <span class="n">State</span><span class="p">]]</span></code>


<a href="#equinox.nn.LayerNorm.__call__" class="headerlink" title="Permanent link">¤</a></h5>

    <div class="doc doc-contents ">

      <p><strong>Arguments:</strong></p>
<ul>
<li><code>x</code>: A JAX array, with the same shape as the <code>shape</code> passed to <code>__init__</code>.</li>
<li><code>state</code>: Ignored; provided for interchangability with the
    <a class="autorefs autorefs-internal" href="#equinox.nn.BatchNorm"><code>equinox.nn.BatchNorm</code></a> API.</li>
<li><code>key</code>: Ignored; provided for compatibility with the rest of the Equinox API.
    (Keyword only argument.)</li>
</ul>
<p><strong>Returns:</strong></p>
<p>The output is a JAX array of the same shape as <code>x</code>.</p>
<p>If <code>state</code> is passed, then a 2-tuple of <code>(output, state)</code> is returned. The state
is passed through unchanged. If <code>state</code> is not passed, then just the output is
returned.</p>

    </div>

  </div>





  </div>

    </div>

  </div>

<hr />


  <div class="doc doc-object doc-class">



<h4 id="equinox.nn.RMSNorm" class="doc doc-heading">
        <code>
equinox.nn.RMSNorm            (<a class="autorefs autorefs-internal" title="equinox.Module" href="../../module/module/index.html#equinox.Module">Module</a>)
        </code>



<a href="#equinox.nn.RMSNorm" class="headerlink" title="Permanent link">¤</a></h4>

    <div class="doc doc-contents first">

      <p>A simplified version of LayerNorm which rescales the inputs, but does not center
them. Optionally applies a learned reweighting of the transformed array afterward.</p>
<p>Given an input array <span class="arithmatex">\(x\)</span>, this layer computes</p>
<div class="arithmatex">\[\frac{x}{\sqrt{\varepsilon + \frac{1}{n}\Vert x \Vert^2_2}} \gamma + \beta\]</div>
<p>where <span class="arithmatex">\(\Vert x \Vert^2_2 = \sum_{i=1}^n x_i^2\)</span>, <span class="arithmatex">\(n = \dim(x)\)</span>, and <span class="arithmatex">\(\gamma\)</span> is a
learned array with the same shape as <span class="arithmatex">\(x\)</span> if <code>use_weight=True</code>, or
<span class="arithmatex">\(\gamma = 1\)</span> if <code>use_weight=False</code>, as proposed in
<a href="https://browse.arxiv.org/abs/2307.14995">this paper</a>. <code>\beta</code> is an optional bias
term.</p>
<details class="cite">
<summary>Cite</summary>
<p><a href="https://browse.arxiv.org/abs/1910.07467">Root Mean Square Layer Normalization</a></p>
<div class="highlight"><pre><span></span><code><span class="nc">@article</span><span class="p">{</span><span class="nl">zhang2019root</span><span class="p">,</span>
<span class="w">    </span><span class="na">title</span><span class="p">=</span><span class="s">{Root Mean Square Layer Normalization}</span><span class="p">,</span>
<span class="w">    </span><span class="na">author</span><span class="p">=</span><span class="s">{Biao Zhang and Rico Sennrich}</span><span class="p">,</span>
<span class="w">    </span><span class="na">year</span><span class="p">=</span><span class="s">{2019}</span><span class="p">,</span>
<span class="w">    </span><span class="na">journal</span><span class="p">=</span><span class="s">{arXiv:1910.07467}</span>
<span class="p">}</span>
</code></pre></div>
</details>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h5 id="equinox.nn.RMSNorm.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span> <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-05</span><span class="p">,</span> <span class="n">use_weight</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span></code>


<a href="#equinox.nn.RMSNorm.__init__" class="headerlink" title="Permanent link">¤</a></h5>

    <div class="doc doc-contents ">

      <p><strong>Arguments:</strong></p>
<ul>
<li><code>shape</code>: Shape of the input.</li>
<li><code>eps</code>: Value added to denominator for numerical stability.</li>
<li><code>use_weight</code>: Whether the module has learnable affine weights.</li>
<li><code>use_bias</code>: Whether the module has learnable affine shift.</li>
<li><code>dtype</code>: The dtype to use for the weight and the bias in this layer if
    <code>use_weight</code> or <code>use_bias</code> is set to <code>True</code>.
    Defaults to either <code>jax.numpy.float32</code> or <code>jax.numpy.float64</code> depending
    on whether JAX is in 64-bit mode.</li>
</ul>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="equinox.nn.RMSNorm.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">State</span> <span class="o">=</span> <span class="n">sentinel</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PRNGKeyArray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Array</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Array</span><span class="p">,</span> <span class="n">State</span><span class="p">]]</span></code>


<a href="#equinox.nn.RMSNorm.__call__" class="headerlink" title="Permanent link">¤</a></h5>

    <div class="doc doc-contents ">

      <p><strong>Arguments:</strong></p>
<ul>
<li><code>x</code>: A JAX array, with the same shape as the <code>shape</code> passed to <code>__init__</code>.</li>
<li><code>state</code>: Ignored; provided for interchangability with the
    <a class="autorefs autorefs-internal" href="#equinox.nn.BatchNorm"><code>equinox.nn.BatchNorm</code></a> API.</li>
<li><code>key</code>: Ignored; provided for compatibility with the rest of the Equinox API.
    (Keyword only argument.)</li>
</ul>
<p><strong>Returns:</strong></p>
<p>The output is a JAX array of the same shape as <code>x</code>.</p>
<p>If <code>state</code> is passed, then a 2-tuple of <code>(output, state)</code> is returned. The state
is passed through unchanged. If <code>state</code> is not passed, then just the output is
returned.</p>

    </div>

  </div>





  </div>

    </div>

  </div>

<hr />


  <div class="doc doc-object doc-class">



<h4 id="equinox.nn.GroupNorm" class="doc doc-heading">
        <code>
equinox.nn.GroupNorm            (<a class="autorefs autorefs-internal" title="equinox.Module" href="../../module/module/index.html#equinox.Module">Module</a>)
        </code>



<a href="#equinox.nn.GroupNorm" class="headerlink" title="Permanent link">¤</a></h4>

    <div class="doc doc-contents first">

      <p>Splits the first dimension ("channels") into groups of fixed size. Computes a mean
and standard deviation over the contents of each group, and uses these to normalise
the group. Optionally applies a channel-wise affine transformation afterwards.</p>
<p>Given an input array <span class="arithmatex">\(x\)</span> of shape <code>(channels, ...)</code>, this layer splits this up into
<code>groups</code>-many arrays <span class="arithmatex">\(x_i\)</span> each of shape <code>(channels/groups, ...)</code>, and for each one
computes</p>
<div class="arithmatex">\[\frac{x_i - \mathbb{E}[x_i]}{\sqrt{\text{Var}[x_i] + \varepsilon}} * \gamma_i + \beta_i\]</div>
<p>where <span class="arithmatex">\(\gamma_i\)</span>, <span class="arithmatex">\(\beta_i\)</span> have shape <code>(channels/groups,)</code> if
<code>channelwise_affine=True</code>, and <span class="arithmatex">\(\gamma = 1\)</span>, <span class="arithmatex">\(\beta = 0\)</span> if
<code>channelwise_affine=False</code>.</p>
<details class="cite">
<summary>Cite</summary>
<p><a href="https://arxiv.org/abs/1803.08494">Group Normalization</a></p>
<div class="highlight"><pre><span></span><code><span class="nc">@article</span><span class="p">{</span><span class="nl">wu2018group</span><span class="p">,</span>
<span class="w">    </span><span class="na">author</span><span class="p">=</span><span class="s">{Yuxin Wu and Kaiming He}</span><span class="p">,</span>
<span class="w">    </span><span class="na">title</span><span class="p">=</span><span class="s">{Group Normalization}</span><span class="p">,</span>
<span class="w">    </span><span class="na">year</span><span class="p">=</span><span class="s">{2018}</span><span class="p">,</span>
<span class="w">    </span><span class="na">journal</span><span class="p">=</span><span class="s">{arXiv:1803.08494}</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div>
</details>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h5 id="equinox.nn.GroupNorm.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">groups</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">channels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-05</span><span class="p">,</span> <span class="n">channelwise_affine</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span></code>


<a href="#equinox.nn.GroupNorm.__init__" class="headerlink" title="Permanent link">¤</a></h5>

    <div class="doc doc-contents ">

      <p><strong>Arguments:</strong></p>
<ul>
<li><code>groups</code>: The number of groups to split the input into.</li>
<li><code>channels</code>: The number of input channels. May be left unspecified (e.g. just
    <code>None</code>) if <code>channelwise_affine=False</code>.</li>
<li><code>eps</code>: Value added to denominator for numerical stability.</li>
<li><code>channelwise_affine</code>: Whether the module has learnable affine parameters.</li>
<li><code>dtype</code>: The dtype to use for the weight and the bias in this layer if
    <code>channelwise_affine</code> is set to <code>True</code>.
    Defaults to either <code>jax.numpy.float32</code> or <code>jax.numpy.float64</code> depending
    on whether JAX is in 64-bit mode.</li>
</ul>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="equinox.nn.GroupNorm.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">State</span> <span class="o">=</span> <span class="n">sentinel</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PRNGKeyArray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Array</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Array</span><span class="p">,</span> <span class="n">State</span><span class="p">]]</span></code>


<a href="#equinox.nn.GroupNorm.__call__" class="headerlink" title="Permanent link">¤</a></h5>

    <div class="doc doc-contents ">

      <p><strong>Arguments:</strong></p>
<ul>
<li><code>x</code>: A JAX array of shape <code>(channels, ...)</code>.</li>
<li><code>state</code>: Ignored; provided for interchangability with the
    <a class="autorefs autorefs-internal" href="#equinox.nn.BatchNorm"><code>equinox.nn.BatchNorm</code></a> API.</li>
<li><code>key</code>: Ignored; provided for compatibility with the rest of the Equinox API.
    (Keyword only argument.)</li>
</ul>
<p><strong>Returns:</strong></p>
<p>The output is a JAX array of shape <code>(channels, ...)</code>.</p>
<p>If <code>state</code> is passed, then a 2-tuple of <code>(output, state)</code> is returned. The state
is passed through unchanged. If <code>state</code> is not passed, then just the output is
returned.</p>

    </div>

  </div>





  </div>

    </div>

  </div>

<hr />


  <div class="doc doc-object doc-class">



<h4 id="equinox.nn.BatchNorm" class="doc doc-heading">
        <code>
equinox.nn.BatchNorm            (<a class="autorefs autorefs-internal" title="equinox.nn.StatefulLayer" href="../sequential/index.html#equinox.nn.StatefulLayer">StatefulLayer</a>)
        </code>



<a href="#equinox.nn.BatchNorm" class="headerlink" title="Permanent link">¤</a></h4>

    <div class="doc doc-contents first">

      <p>Computes a mean and standard deviation over the batch and spatial
dimensions of an array, and uses these to normalise the whole array. Optionally
applies a channelwise affine transformation afterwards.</p>
<p>Given an input array <span class="arithmatex">\(x = [x_1, ... x_C]\)</span> with <span class="arithmatex">\(C\)</span> channels, this layer computes</p>
<div class="arithmatex">\[\frac{x_i - \mathbb{E}[x_i]}{\sqrt{\text{Var}[x_i] + \varepsilon}} * \gamma_i + \beta_i\]</div>
<p>for all <span class="arithmatex">\(i\)</span>. Here <span class="arithmatex">\(*\)</span> denotes elementwise multiplication and <span class="arithmatex">\(\gamma\)</span>, <span class="arithmatex">\(\beta\)</span> have
shape <span class="arithmatex">\((C,)\)</span> if <code>channelwise_affine=True</code> and <span class="arithmatex">\(\gamma = 1\)</span>, <span class="arithmatex">\(\beta = 0\)</span> if
<code>channelwise_affine=False</code>. Expectations are computed over all spatial dimensions
<em>and</em> over the batch dimension, and updated batch-by-batch according to <code>momentum</code>.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>See <a href="../../../examples/stateful/index.html">this example</a> for example usage.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This layer must be used inside of a <code>vmap</code> or <code>pmap</code> with a matching
<code>axis_name</code>. (Not doing so will raise a <code>NameError</code>.)</p>
</div>
<p>Note that this layer behaves differently during training and inference. During
training then statistics are computed using the input data, and the running
statistics updated. During inference then just the running statistics are used.
Whether the model is in training or inference mode should be toggled using
<a class="autorefs autorefs-internal" href="../inference/index.html#equinox.nn.inference_mode"><code>equinox.nn.inference_mode</code></a>.</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h5 id="equinox.nn.BatchNorm.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">axis_name</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Hashable</span><span class="p">]],</span> <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-05</span><span class="p">,</span> <span class="n">channelwise_affine</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">momentum</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.99</span><span class="p">,</span> <span class="n">inference</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span></code>


<a href="#equinox.nn.BatchNorm.__init__" class="headerlink" title="Permanent link">¤</a></h5>

    <div class="doc doc-contents ">

      <p><strong>Arguments:</strong></p>
<ul>
<li><code>input_size</code>: The number of channels in the input array.</li>
<li><code>axis_name</code>: The name of the batch axis to compute statistics over, as passed
    to <code>axis_name</code> in <code>jax.vmap</code> or <code>jax.pmap</code>. Can also be a sequence (e.g. a
    tuple or a list) of names, to compute statistics over multiple named axes.</li>
<li><code>eps</code>: Value added to the denominator for numerical stability.</li>
<li><code>channelwise_affine</code>: Whether the module has learnable channel-wise affine
    parameters.</li>
<li><code>momentum</code>: The rate at which to update the running statistics. Should be a
    value between 0 and 1 exclusive.</li>
<li><code>inference</code>: If <code>False</code> then the batch means and variances will be calculated
    and used to update the running statistics. If <code>True</code> then the running
    statistics are directly used for normalisation. This may be toggled with
    <a class="autorefs autorefs-internal" href="../inference/index.html#equinox.nn.inference_mode"><code>equinox.nn.inference_mode</code></a> or overridden during
    <a class="autorefs autorefs-internal" href="#equinox.nn.BatchNorm.__call__"><code>equinox.nn.BatchNorm.__call__</code></a>.</li>
<li><code>dtype</code>: The dtype to use for the running statistics and the weight and bias
    if <code>channelwise_affine</code> is <code>True</code>. Defaults to either
    <code>jax.numpy.float32</code> or <code>jax.numpy.float64</code> depending on whether JAX is in
    64-bit mode.</li>
</ul>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="equinox.nn.BatchNorm.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">State</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PRNGKeyArray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">inference</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Array</span><span class="p">,</span> <span class="n">State</span><span class="p">]</span></code>


<a href="#equinox.nn.BatchNorm.__call__" class="headerlink" title="Permanent link">¤</a></h5>

    <div class="doc doc-contents ">

      <p><strong>Arguments:</strong></p>
<ul>
<li><code>x</code>: A JAX array of shape <code>(input_size, dim_1, ..., dim_N)</code>.</li>
<li><code>state</code>: An <a class="autorefs autorefs-internal" href="../stateful/index.html#equinox.nn.State"><code>equinox.nn.State</code></a> object (which is used to store the
    running statistics).</li>
<li><code>key</code>: Ignored; provided for compatibility with the rest of the Equinox API.
    (Keyword only argument.)</li>
<li><code>inference</code>: As per <a class="autorefs autorefs-internal" href="#equinox.nn.BatchNorm.__init__"><code>equinox.nn.BatchNorm.__init__</code></a>. If
    <code>True</code> or <code>False</code> then it will take priority over <code>self.inference</code>. If
    <code>None</code> then the value from <code>self.inference</code> will be used.</li>
</ul>
<p><strong>Returns:</strong></p>
<p>A 2-tuple of:</p>
<ul>
<li>A JAX array of shape <code>(input_size, dim_1, ..., dim_N)</code>.</li>
<li>An updated state object (storing the updated running statistics).</li>
</ul>
<p><strong>Raises:</strong></p>
<p>A <code>NameError</code> if no <code>vmap</code>s are placed around this operation, or if this vmap
does not have a matching <code>axis_name</code>.</p>

    </div>

  </div>





  </div>

    </div>

  </div>

<hr />


  <div class="doc doc-object doc-class">



<h4 id="equinox.nn.SpectralNorm" class="doc doc-heading">
        <code>
equinox.nn.SpectralNorm            (<a class="autorefs autorefs-internal" title="equinox.nn.StatefulLayer" href="../sequential/index.html#equinox.nn.StatefulLayer">StatefulLayer</a>)
        </code>



<a href="#equinox.nn.SpectralNorm" class="headerlink" title="Permanent link">¤</a></h4>

    <div class="doc doc-contents first">

      <p>Applies spectral normalisation to a given parameter.</p>
<p>Given a weight matrix <span class="arithmatex">\(W\)</span>, and letting <span class="arithmatex">\(σ(W)\)</span> denote (an approximation to) its
largest singular value, then this computes <span class="arithmatex">\(W/σ(W)\)</span>.</p>
<p>The approximation <span class="arithmatex">\(σ(W)\)</span> is computed using
<a href="https://en.wikipedia.org/wiki/Power_iteration">power iterations</a>
which are updated (as a side-effect) every time <span class="arithmatex">\(W/σ(W)\)</span> is computed.</p>
<p>Spectral normalisation is particularly commonly used when training generative
adversarial networks; see
<a href="https://arxiv.org/abs/1802.05957">Spectral Normalization for Generative Adversarial Networks</a>
for more details and motivation.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>See <a href="../../../examples/stateful/index.html">this example</a> for example usage.</p>
</div>
<p>Note that this layer behaves differently during training and inference. During
training then power iterations are updated; during inference they are fixed.
Whether the model is in training or inference mode should be toggled using
<a class="autorefs autorefs-internal" href="../inference/index.html#equinox.nn.inference_mode"><code>equinox.nn.inference_mode</code></a>.</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h5 id="equinox.nn.SpectralNorm.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer</span><span class="p">:</span> <span class="o">~</span><span class="n">_Layer</span><span class="p">,</span> <span class="n">weight_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">num_power_iterations</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-12</span><span class="p">,</span> <span class="n">inference</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">PRNGKeyArray</span><span class="p">)</span></code>


<a href="#equinox.nn.SpectralNorm.__init__" class="headerlink" title="Permanent link">¤</a></h5>

    <div class="doc doc-contents ">

      <p><strong>Arguments:</strong></p>
<ul>
<li><code>layer</code>: The layer to wrap. Usually a <a class="autorefs autorefs-internal" href="../linear/index.html#equinox.nn.Linear"><code>equinox.nn.Linear</code></a> or
    a convolutional layer (e.g. <a class="autorefs autorefs-internal" href="../conv/index.html#equinox.nn.Conv2d"><code>equinox.nn.Conv2d</code></a>).</li>
<li><code>weight_name</code>: The name of the layer's parameter (a JAX array) to apply
    spectral normalisation to.</li>
<li><code>num_power_iterations</code>: The number of power iterations to apply every time
    the array is accessed.</li>
<li><code>eps</code>: Epsilon for numerical stability when calculating norms.</li>
<li><code>inference</code>: Whether this is in inference mode, at which time no power
    iterations are performed.  This may be toggled with
    <a class="autorefs autorefs-internal" href="../inference/index.html#equinox.nn.inference_mode"><code>equinox.nn.inference_mode</code></a>.</li>
<li><code>key</code>: A <code>jax.random.PRNGKey</code> used to provide randomness for initialisation.
    (Keyword only argument.)</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>The <code>dtype</code> of the weight array of the <code>layer</code> input is applied to all
parameters in this layer.</p>
</div>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="equinox.nn.SpectralNorm.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">State</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PRNGKeyArray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">inference</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Array</span><span class="p">,</span> <span class="n">State</span><span class="p">]</span></code>


<a href="#equinox.nn.SpectralNorm.__call__" class="headerlink" title="Permanent link">¤</a></h5>

    <div class="doc doc-contents ">

      <p><strong>Arguments:</strong></p>
<ul>
<li><code>x</code>: A JAX array.</li>
<li><code>state</code>: An <a class="autorefs autorefs-internal" href="../stateful/index.html#equinox.nn.State"><code>equinox.nn.State</code></a> object (which is used to store the
    power iterations).</li>
<li><code>key</code>: Ignored; provided for compatibility with the rest of the Equinox API.
    (Keyword only argument.)</li>
<li><code>inference</code>: As per <a class="autorefs autorefs-internal" href="#equinox.nn.SpectralNorm.__init__"><code>equinox.nn.SpectralNorm.__init__</code></a>. If
    <code>True</code> or <code>False</code> then it will take priority over <code>self.inference</code>. If
    <code>None</code> then the value from <code>self.inference</code> will be used.</li>
</ul>
<p><strong>Returns:</strong></p>
<p>A 2-tuple of:</p>
<ul>
<li>The JAX array from calling <code>self.layer(x)</code> (with spectral normalisation
    applied).</li>
<li>An updated context object (storing the updated power iterations).</li>
</ul>

    </div>

  </div>





  </div>

    </div>

  </div>

<hr />


  <div class="doc doc-object doc-class">



<h4 id="equinox.nn.WeightNorm" class="doc doc-heading">
        <code>
equinox.nn.WeightNorm            (<a class="autorefs autorefs-internal" title="equinox.Module" href="../../module/module/index.html#equinox.Module">Module</a>)
        </code>



<a href="#equinox.nn.WeightNorm" class="headerlink" title="Permanent link">¤</a></h4>

    <div class="doc doc-contents first">

      <p>Applies weight normalisation to a given parameter.</p>
<p>Given the 2D weight matrix
<span class="arithmatex">\(W = (W_{ij})_{ij} \in \mathbb{R}^{\text{out}} \times \mathbb{R}^{\text{in}}\)</span> of a
linear layer, then it replaces it with the following reparameterisation:</p>
<p><span class="arithmatex">\(g \frac{v_{ij}}{\lVert v_{i\, \cdot} \rVert} \in \mathbb{R}^{\text{out}} \times \mathbb{R}^{\text{in}}\)</span></p>
<p>where <span class="arithmatex">\(v_{ij}\)</span> is initialised as <span class="arithmatex">\(W_{ij}\)</span>, and <span class="arithmatex">\(g\)</span> is initialised as
<span class="arithmatex">\(\lVert v_{i\, \cdot} \rVert = \sum_j {v_{ij}}^2\)</span>.</p>
<p>Overall, the direction (<span class="arithmatex">\(v\)</span>) and the magnitude (<span class="arithmatex">\(g\)</span>) of the output of each neuron
are treated separately.</p>
<p>Given n-dimensional weight matrices <span class="arithmatex">\(W\)</span> (in convolutional layers), then the
normalisation is analogusly instead computed over every axis except the first.</p>
<details class="cite">
<summary>Cite</summary>
<p><a href="https://arxiv.org/abs/1602.07868">Weight Normalisation</a></p>
<div class="highlight"><pre><span></span><code><span class="nc">@article</span><span class="p">{</span><span class="nl">DBLP:journals/corr/SalimansK16</span><span class="p">,</span>
<span class="na">author</span><span class="w">       </span><span class="p">=</span><span class="w"> </span><span class="s">{Tim Salimans and</span>
<span class="s">                Diederik P. Kingma}</span><span class="p">,</span>
<span class="na">title</span><span class="w">        </span><span class="p">=</span><span class="w"> </span><span class="s">{Weight Normalisation: {A} Simple</span>
<span class="s">                Reparameterization to Accelerate</span>
<span class="s">                Training of Deep Neural Networks}</span><span class="p">,</span>
<span class="na">journal</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="s">{CoRR}</span><span class="p">,</span>
<span class="na">volume</span><span class="w">       </span><span class="p">=</span><span class="w"> </span><span class="s">{abs/1602.07868}</span><span class="p">,</span>
<span class="na">year</span><span class="w">         </span><span class="p">=</span><span class="w"> </span><span class="s">{2016}</span><span class="p">,</span>
<span class="na">url</span><span class="w">          </span><span class="p">=</span><span class="w"> </span><span class="s">{http://arxiv.org/abs/1602.07868}</span><span class="p">,</span>
<span class="na">eprinttype</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="s">{arXiv}</span><span class="p">,</span>
<span class="na">eprint</span><span class="w">       </span><span class="p">=</span><span class="w"> </span><span class="s">{1602.07868}</span><span class="p">,</span>
<span class="na">timestamp</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="s">{Mon, 13 Aug 2018 16:47:07 +0200}</span><span class="p">,</span>
<span class="na">biburl</span><span class="w">       </span><span class="p">=</span><span class="w"> </span><span class="s">{https://dblp.org/rec/journals/corr/SalimansK16.bib}</span><span class="p">,</span>
<span class="na">bibsource</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="s">{dblp computer science bibliography, https://dblp.org}</span>
<span class="p">}</span>
</code></pre></div>
</details>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h5 id="equinox.nn.WeightNorm.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer</span><span class="p">:</span> <span class="o">~</span><span class="n">_Layer</span><span class="p">,</span> <span class="n">weight_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span></code>


<a href="#equinox.nn.WeightNorm.__init__" class="headerlink" title="Permanent link">¤</a></h5>

    <div class="doc doc-contents ">

      <p><strong>Arguments:</strong></p>
<ul>
<li><code>layer</code>: The layer to wrap. Usually a <a class="autorefs autorefs-internal" href="../linear/index.html#equinox.nn.Linear"><code>equinox.nn.Linear</code></a> or
    a convolutional layer (e.g. <a class="autorefs autorefs-internal" href="../conv/index.html#equinox.nn.Conv2d"><code>equinox.nn.Conv2d</code></a>).</li>
<li><code>weight_name</code>: The name of the layer's parameter (a JAX array) to apply
    weight normalisation to.</li>
<li><code>axis</code>: The norm is computed across every axis except this one.
    If <code>None</code>, compute across every axis.</li>
</ul>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="equinox.nn.WeightNorm.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PRNGKeyArray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span></code>


<a href="#equinox.nn.WeightNorm.__call__" class="headerlink" title="Permanent link">¤</a></h5>

    <div class="doc doc-contents ">

      <p><strong>Arguments:</strong></p>
<ul>
<li><code>x</code>: A JAX Array.</li>
<li><code>key</code>: Ignored; provided for compatibility with the rest of the Equinox API.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>The JAX array from calling <code>self.layer(x)</code> (with weight normalisation
applied).</li>
</ul>

    </div>

  </div>





  </div>

    </div>

  </div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../dropout/index.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Dropout" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Dropout
            </div>
          </div>
        </a>
      
      
        
        <a href="../embedding/index.html" class="md-footer__link md-footer__link--next" aria-label="Next: Embeddings" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Embeddings
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.sections", "toc.integrate", "header.autohide"], "search": "../../../assets/javascripts/workers/search.fcfe8b6d.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.b1047164.min.js"></script>
      
        <script src="../../../_static/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>

<!-- Mirrored from docs.kidger.site/equinox/api/nn/normalisation/ by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Jul 2024 11:53:49 GMT -->
</html>